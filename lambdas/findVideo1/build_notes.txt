# cd lambdas/findVideo1/src
cp ../../../python-test-module/src/library.py .
cp ../../../python-test-module/models/video1.pkl .

docker build -t find-video1 .
# To test it locally run these 2 lines in separate command windows:
#   docker run -p 9000:8080 find-video1
#   curl -XPOST "http://localhost:9000/2015-03-31/functions/function/invocations" -H 'Content-Type: application/json' -d '{"body": "{\"data\":\"0.10\"}"}'

aws ecr get-login-password --region us-east-1 --profile stem-computer | docker login --username AWS --password-stdin 537053210946.dkr.ecr.us-east-1.amazonaws.com
docker tag find-video1:latest 537053210946.dkr.ecr.us-east-1.amazonaws.com/find-video1:latest
docker push 537053210946.dkr.ecr.us-east-1.amazonaws.com/find-video1:latest
aws lambda update-function-code --no-cli-pager --region us-east-1 --profile stem-computer --function-name findVideo1 --image-uri 537053210946.dkr.ecr.us-east-1.amazonaws.com/find-video1:latest


# To test it as an API run this:
# NOTE: The below isn't right
#   curl -XPOST "https://ywpaxgg1if.execute-api.us-east-1.amazonaws.com/prod/find-video1" -H 'Content-Type: application/json' -d '[0.0, 0.0, 0.0, 0.7663412112887931, -0.5771475810628254, -0.28217338207874093, 1.2848490008663382, -1.632664497335636, -0.2903629588151107, 1.1413968518117388, -2.8418818424948555, -0.2881294435932977, 0.8863344308293286, -3.6829987054555557, -0.25859722068627233, 1.1439959974235432, -3.2493384241801015, 0.314675243165136, 1.2757673905936657, -4.515936495053607, 0.3241057035375124, 1.2791124012779973, -5.2836325160140865, 0.23910750739171804, 1.268463737861474, -5.948881893695895, 0.15894864653415677, 0.7480604868653256, -3.472874320324018, 0.3650537546038032, 0.9145363658853869, -4.827529663554996, 0.41170969882667147, 0.9739765897712113, -5.648717065340794, 0.3092155183665377, 1.0203584838167916, -6.356197537681171, 0.21875759742214512, 0.3935312004366336, -3.473622863547613, 0.3414776141343898, 0.5392627908192567, -4.718395342289846, 0.33080631197211724, 0.6298040482925955, -5.37852342559126, 0.23836300231778038, 0.6754558114031752, -5.919774408809861, 0.16986811705440855, -0.016446860479435565, -3.276431269924992, 0.274968096657907, 0.10381484370569895, -4.281215300972853, 0.23724625516840145, 0.20693905920465494, -4.897737728579884, 0.1995244346019511, 0.3135495578567962, -5.460301438000173, 0.17334249498917298]'
